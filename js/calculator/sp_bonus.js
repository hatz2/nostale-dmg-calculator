export {
    calculateBonusFromSp as calculate_bonus_from_sp,
    getStrArrayFromBonuses as get_str_array_from_bonuses
}

const BONUS_NAMES = {
    2730: "Attack power +",
    2726: "Hit Rate +",
    2727: "Deathblow rate +",
    2728: "Deathblow damage +",
    2729: "HP/MP +",
    2731: "Evade close/long range combat +",
    2733: "Decreasing deathblow +",
    2790: "Improve in decreases of short distance /long distance/magic damage",
    2732: "HP +",
    2734: "Water/Fire/Light/Shadow resistance +",
    2738: "Element +",
    2737: "MP +",
    2735: "Decreasing magic damage +",
    2736: "Water/Fire/Light/Shadow resistance +",
    2739: "Increasing attack power +",
    2740: "All defences +",
    2741: "All resistances +",
    2743: "Reduces the probability of receiving a critical hit.",
    2742: "Evade close/long range attacks +"
}

const BONUS = {
    attack: {
        1: {
            2730: 5
        },
        10: {
            2730: 5,
            2726: 10,
        },
        20: {
            2730: 5,
            2726: 10,
            2727: 2
        },
        30: {
            2730: 10,
            2726: 20,
            2727: 2
        },
        40: {
            2730: 10,
            2726: 20,
            2727: 2,
            2728: 10,
        },
        50: {
            2730: 10,
            2726: 20,
            2727: 2,
            2728: 10,
            2729: 200
        },
        60: {
            2730: 10,
            2726: 35,
            2727: 2,
            2728: 10,
            2729: 200
        },
        70: {
            2730: 10,
            2726: 50,
            2727: 2,
            2728: 10,
            2729: 200
        },
        80: {
            2730: 10,
            2726: 50,
            2727: 5,
            2728: 10,
            2729: 200
        },
        90: {
            2730: 10,
            2726: 50,
            2727: 5,
            2728: 30,
            2729: 200
        },
        100: {
            2730: 20,
            2726: 70,
            2727: 8,
            2728: 50,
            2729: 400
        }
    },

    defence: {
        10: {
            2731: 5,
        },
        20: {
            2731: 5,
            2733: 2,
            2790: 1,
        },
        30: {
            2731: 5,
            2732: 100,
            2733: 2,
            2790: 1,
        },
        40: {
            2731: 5,
            2732: 100,
            2733: 4,
            2790: 2,
        },
        50: {
            2731: 10,
            2732: 100,
            2733: 4,
            2790: 2,
        },
        60: {
            2731: 10,
            2732: 300,
            2733: 4,
            2790: 2,
        },
        70: {
            2731: 10,
            2732: 300,
            2733: 7,
            2790: 2,
        },
        75: {
            2731: 10,
            2732: 300,
            2733: 7,
            2790: 3,
        },
        80: {
            2731: 20,
            2732: 300,
            2733: 10,
            2734: 2,
            2790: 3,
        },
        90: {
            2731: 20,
            2732: 300,
            2733: 10,
            2734: 5,
            2790: 4,
        },
        95: {
            2731: 20,
            2732: 600,
            2733: 10,
            2734: 5,
            2790: 4,
        },
        100: {
            2731: 40,
            2732: 600,
            2733: 10,
            2734: 10,
            2790: 5,
        }
    },

    element: {
        1: {
            2738: 2,
        },
        10: {
            2737: 100,
            2738: 2,
        },
        20: {
            2735: 5,
            2737: 100,
            2738: 2,
        },
        30: {
            2735: 5,
            2736: 2,
            2737: 100,
            2738: 4,
        },
        40: {
            2735: 5,
            2736: 2,
            2737: 200,
            2738: 4,
        },
        50: {
            2735: 10,
            2736: 2,
            2737: 200,
            2738: 4,
        },
        60: {
            2735: 10,
            2736: 5,
            2737: 200,
            2738: 6,
        },
        70: {
            2735: 10,
            2736: 5,
            2737: 300,
            2738: 6,
        },
        80: {
            2735: 15,
            2736: 5,
            2737: 300,
            2738: 6,
        },
        90: {
            2735: 15,
            2736: 9,
            2737: 300,
            2738: 8,
        },
        100: {
            2735: 20,
            2736: 15,
            2737: 500,
            2738: 10,
        },
    },

    hp_mp: {
        5: {
            2739: 5,
        },
        10: {
            2739: 10,  
        },
        15: {
            2739: 15,
        },
        20: {
            2739: 20, 
            2740: 10,
        },
        25: {
            2739: 25, 
            2740: 10,
        },
        30: {
            2739: 30, 
            2740: 10,
        },
        35: {
            2739: 35, 
            2740: 10,
        },
        40: {
            2739: 40, 
            2740: 25,
        },
        45: {
            2739: 50, 
            2740: 25,
        },
        50: {
            2739: 60, 
            2740: 25,
            2741: 2,
        },
        55: {
            2739: 70, 
            2740: 25,
            2741: 2,
        },
        60: {
            2739: 80, 
            2740: 25,
            2741: 2,
        },
        65: {
            2739: 90, 
            2740: 25,
            2741: 2,
        },
        70: {
            2739: 100, 
            2740: 45,
            2741: 2,
        },
        75: {
            2739: 115, 
            2740: 45,
            2741: 2,
        },
        80: {
            2739: 130, 
            2740: 45,
            2741: 2,
        },
        85: {
            2739: 145, 
            2740: 45,
            2741: 2,
            2743: 1,
        },
        86: {
            2739: 145, 
            2740: 45,
            2741: 2,
            2743: 2,
        },
        87: {
            2739: 145, 
            2740: 45,
            2741: 2,
            2743: 3,
        },
        88: {
            2739: 145, 
            2740: 45,
            2741: 2,
            2743: 4,
        },
        90: {
            2739: 160, 
            2740: 70,
            2741: 2,
            2743: 4,
        },
        91: {
            2739: 160, 
            2740: 70,
            2741: 2,
            2742: 2,
            2743: 4,
        },
        92: {
            2739: 160, 
            2740: 70,
            2741: 2,
            2742: 4,
            2743: 4,
        },
        93: {
            2739: 160, 
            2740: 70,
            2741: 2,
            2742: 6,
            2743: 4,
        },
        94: {
            2739: 160, 
            2740: 70,
            2741: 2,
            2742: 8,
            2743: 4,
        },
        95: {
            2739: 180, 
            2740: 70,
            2741: 2,
            2742: 10,
            2743: 4,
        },
        96: {
            2739: 180, 
            2740: 70,
            2741: 2,
            2742: 12,
            2743: 4,
        },
        97: {
            2739: 180, 
            2740: 70,
            2741: 2,
            2742: 14,
            2743: 4,
        },
        98: {
            2739: 180, 
            2740: 70,
            2741: 2,
            2742: 16,
            2743: 4,
        },
        99: {
            2739: 180, 
            2740: 70,
            2741: 2,
            2742: 18,
            2743: 4,
        },
        100: {
            2739: 200, 
            2740: 100,
            2741: 5,
            2742: 20,
            2743: 5,
        }
    }
}

function calculateBonusFromSp(sp_config) {
    let bonuses = {}
    let keywords = ["attack", "defence", "element", "hp_mp"]

    for (let keyword of keywords) {
        let bonuses_to_use = BONUS[keyword];

        for (let i = 100; i >= 1; i--) {
            if (!Object.hasOwn(bonuses_to_use, i))
                continue;

            if (sp_config[keyword] >= i) {
                let bonus = bonuses_to_use[i]
                for (let key in bonus) {
                    if (bonuses[key] === undefined) {
                        bonuses[key] = 0
                    }
                    bonuses[key] += bonus[key]
                }
                break
            }
        }
    }

    return bonuses;
}

function getStrArrayFromBonuses(bonuses) {
    let str_array = []
    for (let key in bonuses) {
        let bonus = bonuses[key]
        str_array.push(`${BONUS_NAMES[key]} ${bonus}`)
    }
    return str_array
}